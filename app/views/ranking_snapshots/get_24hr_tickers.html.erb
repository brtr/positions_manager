<div class="m-3 get_24hr_tickers_page">
  <h3>
    最近24小时币种涨跌排名列表
    <%= link_to "Refresh", refresh_24hr_ticker_path, class: 'btn btn-warning' %>
  </h3>
  <div class="row mt-3">
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>24小时涨幅</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @daily_ranking.sort_by{|d| d["priceChangePercent"].to_f}.reverse.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url(d["symbol"], get_top10_count(d["source"], d["symbol"])) %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>24小时变动</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @daily_ranking.select{|d| d["priceChangePercent"].to_f < 0}.sort_by{|d| d["bottomPriceRatio"].to_f}.reverse.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <div class="mt-3 col-4">
    <%= form_tag get_24hr_tickers_ranking_snapshots_path, id: "search_targets", class: "position-relative", method: "GET" do %>
      <div class="input-group mb-3">
        <%= select_tag(:select, options_for_select([["所有币种", 0], ["前100名以外",100],["前200名以外",200]], params[:select] ),{ prompt: '请选择币种排名', class: 'select2-dropdown', onchange: 'this.form.submit()' }) %>
      </div>
    <% end %>
  </div>
  <h3 class='mt-5'>最近一年距离底部超过一倍的币种</h3>
  <div class="row mt-3">
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>距离底部上涨幅度</th>
            <th>距离顶部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @daily_ranking.select{|d| d["risenRatio"].to_f > 100}.sort_by{|d| d["risenRatio"]}.reverse.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["risenRatio"].to_s + " %" %></td>
              <td><%= d["topPriceRatio"].to_s + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>距离顶部比例</th>
            <th>距离底部上涨幅度</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @daily_ranking.select{|d| d["topPriceRatio"] != 0}.sort_by{|d| d["topPriceRatio"]}.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["topPriceRatio"].to_s + " %" %></td>
              <td><%= d["risenRatio"].to_s + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <h3 class="mt-5">最近3天币种涨跌排名列表</h3>
  <div class="row mt-3">
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>3天内涨幅</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @three_days_ranking.sort_by{|d| d["priceChangePercent"].to_f}.reverse.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>3天内跌幅</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @three_days_ranking.sort_by{|d| d["priceChangePercent"].to_f}.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <h3 class="mt-5">最近一周币种涨跌排名列表</h3>
  <div class="row mt-3">
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>一周内涨幅</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @weekly_ranking.sort_by{|d| d["priceChangePercent"].to_f}.reverse.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="col-6">
      <table class="table">
        <thead>
          <tr class="table-container-tr">
            <th>币种</th>
            <th>一周内跌幅</th>
            <th>一年内底部比例</th>
            <th>来源</th>
          </tr>
        </thead>
        <tbody>
          <% @weekly_ranking.sort_by{|d| d["priceChangePercent"].to_f}.first(10).each do |d| %>
            <tr>
              <td><%= get_symbol_url d["symbol"] %></td>
              <td><%= d["priceChangePercent"] + " %" %></td>
              <td><%= d["bottomPriceRatio"] + " %" %></td>
              <td><%= d["source"] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div id="ranking-modal-block">
</div>